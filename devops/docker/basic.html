<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础部分 | 技术知识体系</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="技术知识体系">
    
    <link rel="preload" href="/assets/css/0.styles.c5842e21.css" as="style"><link rel="preload" href="/assets/js/app.0bfcc16d.js" as="script"><link rel="preload" href="/assets/js/5.5b20aa35.js" as="script"><link rel="preload" href="/assets/js/4.589a219c.js" as="script"><link rel="prefetch" href="/assets/js/10.e20869d1.js"><link rel="prefetch" href="/assets/js/11.24bd1892.js"><link rel="prefetch" href="/assets/js/12.775246f2.js"><link rel="prefetch" href="/assets/js/13.bcdfc124.js"><link rel="prefetch" href="/assets/js/14.5a60cc02.js"><link rel="prefetch" href="/assets/js/15.f505b702.js"><link rel="prefetch" href="/assets/js/16.4fe842df.js"><link rel="prefetch" href="/assets/js/17.6219536e.js"><link rel="prefetch" href="/assets/js/18.20f61506.js"><link rel="prefetch" href="/assets/js/19.795d85d0.js"><link rel="prefetch" href="/assets/js/2.7e1cd3b2.js"><link rel="prefetch" href="/assets/js/20.27250a5b.js"><link rel="prefetch" href="/assets/js/21.e9c6d688.js"><link rel="prefetch" href="/assets/js/22.461ad53a.js"><link rel="prefetch" href="/assets/js/23.2728355e.js"><link rel="prefetch" href="/assets/js/24.2687158e.js"><link rel="prefetch" href="/assets/js/25.a99e2cf2.js"><link rel="prefetch" href="/assets/js/26.afd96250.js"><link rel="prefetch" href="/assets/js/27.c7fd0180.js"><link rel="prefetch" href="/assets/js/28.afa200ae.js"><link rel="prefetch" href="/assets/js/29.936503f2.js"><link rel="prefetch" href="/assets/js/3.f79f3318.js"><link rel="prefetch" href="/assets/js/30.a88d3c3e.js"><link rel="prefetch" href="/assets/js/31.4ec6bcb4.js"><link rel="prefetch" href="/assets/js/32.3d9e24dc.js"><link rel="prefetch" href="/assets/js/33.6307975d.js"><link rel="prefetch" href="/assets/js/34.4900183c.js"><link rel="prefetch" href="/assets/js/35.57389bb2.js"><link rel="prefetch" href="/assets/js/36.e86c7b24.js"><link rel="prefetch" href="/assets/js/37.9ff79e30.js"><link rel="prefetch" href="/assets/js/38.aba9f67e.js"><link rel="prefetch" href="/assets/js/39.cfad2f1c.js"><link rel="prefetch" href="/assets/js/40.6c767a38.js"><link rel="prefetch" href="/assets/js/41.58743efa.js"><link rel="prefetch" href="/assets/js/42.ced37a70.js"><link rel="prefetch" href="/assets/js/43.ce3c6ec9.js"><link rel="prefetch" href="/assets/js/44.4cba0e70.js"><link rel="prefetch" href="/assets/js/45.714a850d.js"><link rel="prefetch" href="/assets/js/46.815aa710.js"><link rel="prefetch" href="/assets/js/47.02d78fec.js"><link rel="prefetch" href="/assets/js/48.35a0eea1.js"><link rel="prefetch" href="/assets/js/49.79feb57e.js"><link rel="prefetch" href="/assets/js/50.a01efd1c.js"><link rel="prefetch" href="/assets/js/6.d062a931.js"><link rel="prefetch" href="/assets/js/7.c78c9b51.js"><link rel="prefetch" href="/assets/js/8.ee8ee0dd.js"><link rel="prefetch" href="/assets/js/9.d1fc65b1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c5842e21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术知识体系</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/javase/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/java/javaee/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/java/juc/" class="nav-link">
  并发编程
</a></li><li class="dropdown-item"><!----> <a href="/java/io/" class="nav-link">
  BIO/NIO/AIO
</a></li><li class="dropdown-item"><!----> <a href="/java/algorithm/" class="nav-link">
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/java/design_pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/java/jvm/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/java/jdk8/" class="nav-link">
  JDK8新特性
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/springmvc/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-item"><!----> <a href="/framework/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/framework/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/framework/springcloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/framework/activiti7/" class="nav-link">
  Activiti7
</a></li><li class="dropdown-item"><!----> <a href="/middle/netty/" class="nav-link">
  Netty
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/middle/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/middle/rabbitmq/" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-item"><!----> <a href="/middle/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/middle/zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/middle/emqx/" class="nav-link">
  EMQX
</a></li><li class="dropdown-item"><!----> <a href="/middle/tomcat/" class="nav-link">
  Tomcat
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/db/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-subitem"><a href="/db/sqlserver/" class="nav-link">
  SQL Server
</a></li></ul></li><li class="dropdown-item"><h4>
          非关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/db/mongodb/" class="nav-link">
  MongoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/frontend/engineering/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维|工具" class="dropdown-title"><span class="title">运维|工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维|工具" class="mobile-dropdown-title"><span class="title">运维|工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link router-link-active">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/k8s/" class="nav-link">
  K8S
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bigdata/hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/oozie/" class="nav-link">
  Oozie
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/hbase/" class="nav-link">
  Hbase
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/flume/" class="nav-link">
  Flume
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/spark/" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/flink/" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="安卓" class="dropdown-title"><span class="title">安卓</span> <span class="arrow down"></span></button> <button type="button" aria-label="安卓" class="mobile-dropdown-title"><span class="title">安卓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/linux/" class="nav-link">
  布局
</a></li><li class="dropdown-item"><!----> <a href="/android/docker/" class="nav-link">
  四大组件
</a></li><li class="dropdown-item"><!----> <a href="/android/docker/" class="nav-link">
  碎片
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  动画
</a></li><li class="dropdown-item"><!----> <a href="/android/k8s/" class="nav-link">
  数据存储
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  常用控件
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  自定义控件
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  绘图API
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  drawable
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  网络请求
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  多媒体
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="嵌入式" class="dropdown-title"><span class="title">嵌入式</span> <span class="arrow down"></span></button> <button type="button" aria-label="嵌入式" class="mobile-dropdown-title"><span class="title">嵌入式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/iot/digital/" class="nav-link">
  C/C++
</a></li><li class="dropdown-item"><!----> <a href="/iot/51/" class="nav-link">
  51单片机
</a></li></ul></div></div><div class="nav-item"><a href="/pmp/" class="nav-link">
  项目管理
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  个人博客
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/javase/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/java/javaee/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/java/juc/" class="nav-link">
  并发编程
</a></li><li class="dropdown-item"><!----> <a href="/java/io/" class="nav-link">
  BIO/NIO/AIO
</a></li><li class="dropdown-item"><!----> <a href="/java/algorithm/" class="nav-link">
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/java/design_pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/java/jvm/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/java/jdk8/" class="nav-link">
  JDK8新特性
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/springmvc/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-item"><!----> <a href="/framework/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/framework/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/framework/springcloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/framework/activiti7/" class="nav-link">
  Activiti7
</a></li><li class="dropdown-item"><!----> <a href="/middle/netty/" class="nav-link">
  Netty
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/middle/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/middle/rabbitmq/" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-item"><!----> <a href="/middle/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/middle/zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/middle/emqx/" class="nav-link">
  EMQX
</a></li><li class="dropdown-item"><!----> <a href="/middle/tomcat/" class="nav-link">
  Tomcat
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/db/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-subitem"><a href="/db/sqlserver/" class="nav-link">
  SQL Server
</a></li></ul></li><li class="dropdown-item"><h4>
          非关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/db/mongodb/" class="nav-link">
  MongoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/frontend/engineering/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维|工具" class="dropdown-title"><span class="title">运维|工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维|工具" class="mobile-dropdown-title"><span class="title">运维|工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link router-link-active">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/k8s/" class="nav-link">
  K8S
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bigdata/hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/oozie/" class="nav-link">
  Oozie
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/hbase/" class="nav-link">
  Hbase
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/flume/" class="nav-link">
  Flume
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/spark/" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/bigdata/flink/" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="安卓" class="dropdown-title"><span class="title">安卓</span> <span class="arrow down"></span></button> <button type="button" aria-label="安卓" class="mobile-dropdown-title"><span class="title">安卓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/linux/" class="nav-link">
  布局
</a></li><li class="dropdown-item"><!----> <a href="/android/docker/" class="nav-link">
  四大组件
</a></li><li class="dropdown-item"><!----> <a href="/android/docker/" class="nav-link">
  碎片
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  动画
</a></li><li class="dropdown-item"><!----> <a href="/android/k8s/" class="nav-link">
  数据存储
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  常用控件
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  自定义控件
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  绘图API
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  drawable
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  网络请求
</a></li><li class="dropdown-item"><!----> <a href="/android/animation/" class="nav-link">
  多媒体
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="嵌入式" class="dropdown-title"><span class="title">嵌入式</span> <span class="arrow down"></span></button> <button type="button" aria-label="嵌入式" class="mobile-dropdown-title"><span class="title">嵌入式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/iot/digital/" class="nav-link">
  C/C++
</a></li><li class="dropdown-item"><!----> <a href="/iot/51/" class="nav-link">
  51单片机
</a></li></ul></div></div><div class="nav-item"><a href="/pmp/" class="nav-link">
  项目管理
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  个人博客
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/devops/docker/basic.html" aria-current="page" class="active sidebar-link">基础部分</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_1-下载地址" class="sidebar-link">1. 下载地址</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-docker安装" class="sidebar-link">2. Docker安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-1-前提说明" class="sidebar-link">2.1 前提说明</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-2-docker基本组成" class="sidebar-link">2.2 Docker基本组成</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-3-docker架构图解-入门版" class="sidebar-link">2.3 Docker架构图解(入门版)</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-4-安装步骤" class="sidebar-link">2.4 安装步骤</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_2-5-阿里云镜像加速" class="sidebar-link">2.5 阿里云镜像加速</a></li></ul></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_3-docker常用命令" class="sidebar-link">3. Docker常用命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_3-1-启动帮助命令" class="sidebar-link">3.1 启动帮助命令</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_3-2-镜像命令" class="sidebar-link">3.2 镜像命令</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_3-3-容器命令" class="sidebar-link">3.3 容器命令</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_3-4-小结" class="sidebar-link">3.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_4-docker镜像" class="sidebar-link">4. Docker镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_4-1-简介" class="sidebar-link">4.1 简介</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_4-2-重点理解" class="sidebar-link">4.2 重点理解</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_4-3-commit操作" class="sidebar-link">4.3 commit操作</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_4-4-总结" class="sidebar-link">4.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_5-镜像发布到阿里云" class="sidebar-link">5. 镜像发布到阿里云</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_5-1-镜像发布到阿里云流程" class="sidebar-link">5.1 镜像发布到阿里云流程</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_5-2-镜像生成的方法" class="sidebar-link">5.2 镜像生成的方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_6-阿里云镜像下载到本地" class="sidebar-link">6. 阿里云镜像下载到本地</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_7-本地镜像发布到私有库" class="sidebar-link">7. 本地镜像发布到私有库</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_8-数据卷" class="sidebar-link">8. 数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_8-1-坑-容器卷记得加入" class="sidebar-link">8.1 坑：容器卷记得加入</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_8-2-参数v" class="sidebar-link">8.2 参数V</a></li><li class="sidebar-sub-header"><a href="/devops/docker/basic.html#_8-3-案例" class="sidebar-link">8.3 案例</a></li></ul></li></ul></li><li><a href="/devops/docker/advanced.html" class="sidebar-link">高级部分</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基础部分"><a href="#基础部分" class="header-anchor">#</a> 基础部分</h1> <h2 id="_1-下载地址"><a href="#_1-下载地址" class="header-anchor">#</a> 1. 下载地址</h2> <p>官网：https://www.docker.com</p> <p>Docker Hub 官网：https://hub.docker.com</p> <h2 id="_2-docker安装"><a href="#_2-docker安装" class="header-anchor">#</a> 2. Docker安装</h2> <h3 id="_2-1-前提说明"><a href="#_2-1-前提说明" class="header-anchor">#</a> 2.1 前提说明</h3> <h4 id="_2-1-1-centos上安装docker"><a href="#_2-1-1-centos上安装docker" class="header-anchor">#</a> 2.1.1 CentOS上安装Docker</h4> <br> <img src="/assets/img/13.b22cc0f0.png" style="zoom:60%;"> <br> <h4 id="_2-1-2-前提条件"><a href="#_2-1-2-前提条件" class="header-anchor">#</a> 2.1.2 前提条件</h4> <p>目前，CentOS仅发行版本中的内核支持Docker。Docker运行在CentOS 7(64-bit)上，要求系统为64位，Linux系统内核版本为3.8以上，这里选用Centos7.x。</p> <h4 id="_2-1-3-查看系统内核"><a href="#_2-1-3-查看系统内核" class="header-anchor">#</a> 2.1.3 查看系统内核</h4> <p>uname 命令用于打印当前系统相关信息（内核版本号，硬件架构，主机名称和操作系统类型等）。</p> <img src="/assets/img/14.39c626db.png" style="zoom:50%;"> <br> <h3 id="_2-2-docker基本组成"><a href="#_2-2-docker基本组成" class="header-anchor">#</a> 2.2 Docker基本组成</h3> <h4 id="_2-2-1-镜像-image"><a href="#_2-2-1-镜像-image" class="header-anchor">#</a> 2.2.1 镜像(image)</h4> <ul><li>Docker 镜像（image）就是一个 <strong>只读</strong> 的模板。镜像可以用来创建 Docker 容器， 一个镜像可以创建很多容器</li> <li>它也相当于是一个root文件系统。比如官方镜像 centos:7 就包含了完整的一套 centos:7 最小系统的 root 文件系统</li> <li>相当于容器的“源代码”， docker镜像文件类似于Java的类模板，而docker容器实例类似于java中new出来的实例对象</li></ul> <br> <br> <h4 id="_2-2-2-容器-container"><a href="#_2-2-2-容器-container" class="header-anchor">#</a> 2.2.2 容器(container)</h4> <p>从面向对象角度</p> <ul><li>Docker 利用容器（Container）独立运行的一个或一组应用，应用程序或服务运行在容器里面，容器就类似于一个虚拟化的运行环境， 容器是用镜像创建的运行实例 。就像是Java中的类和实例对象一样，镜像是静态的定义，容器是镜像运行时的实体。容器为镜像提供了一个标准的和隔离的运行环境，它可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台</li></ul> <br> <p>从镜像容器角度</p> <ul><li><strong>可以把容器看做是一个简易版的</strong> *<strong>Linux*</strong> <strong>环境</strong> （包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序</li></ul> <h4 id="_2-2-3-仓库-repository"><a href="#_2-2-3-仓库-repository" class="header-anchor">#</a> 2.2.3 仓库(repository)</h4> <p>仓库（Repository）是 集中存放镜像文件的场所。</p> <p>类似于</p> <ul><li>Maven仓库，存放各种jar包的地方</li> <li>github仓库，存放各种git项目的地方</li></ul> <p>Docker公司提供的官方registry被称为Docker Hub，存放各种镜像模板的地方。</p> <p>仓库分为公开仓库（Public）和私有仓库（Private）两种形式。</p> <p>最大的公开仓库是 Docker Hub（https://hub.docker.com/）， 存放了数量庞大的镜像供用户下载。</p> <p>国内的公开仓库包括阿里云 、网易云等 。</p> <h4 id="_2-2-4-小结"><a href="#_2-2-4-小结" class="header-anchor">#</a> 2.2.4 小结</h4> <p>需要正确的理解仓库/镜像/容器这几个概念:</p> <ul><li>Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个可交付的运行环境，这个打包好的运行环境就是image镜像文件。只有通过这个镜像文件才能生成Docker容器实例(类似Java中new出来一个对象)。</li> <li>image文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</li></ul> <br> <p>镜像文件</p> <ul><li>image 文件生成的容器实例，本身也是一个文件，称为镜像文件。</li></ul> <br> <p>容器实例</p> <ul><li>一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器 。</li></ul> <br> <p>仓库</p> <ul><li>就是放一堆镜像的地方，我们可以把镜像发布到仓库中，需要的时候再从仓库中拉下来就可以了。</li></ul> <h3 id="_2-3-docker架构图解-入门版"><a href="#_2-3-docker架构图解-入门版" class="header-anchor">#</a> 2.3 Docker架构图解(入门版)</h3> <img src="/assets/img/15.e8dd358c.png" style="zoom:70%;"> <br> <h4 id="_2-3-1-工作原理"><a href="#_2-3-1-工作原理" class="header-anchor">#</a> 2.3.1 工作原理</h4> <p>Docker是一个 Client-Server 结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户端访问，守护进程从客户端接受命令并管理运行在主机上的容器 。 容器，是一个运行时环境，就是我们前面说到的集装箱。</p> <img src="/assets/img/16.a27184f3.png" style="zoom:50%;"> <br> <p>Docker是一个C/S模式的架构，后端是一个松耦合架构，众多模块各司其职。</p> <h4 id="_2-3-2-运行基本流程"><a href="#_2-3-2-运行基本流程" class="header-anchor">#</a> 2.3.2 运行基本流程</h4> <ol><li>用户是使用 <code>Docker Client</code> 与 <code>Docker Daemon</code> 建立通信，并发送请求给后者</li> <li><code>Docker Daemon</code> 作为Docker架构中的主体部分，首先提供 <code>Docker Server</code> 的功能时期可以接受 Docker Client 的请求</li> <li><code>Docker Engine</code> 执行Docker内部的一系列工作，每一项工作都是以一个 <code>Job</code> 的形式的存在</li> <li>Job 的运行过程中，当需要容器镜像时，则从Docker Register中下载镜像，并通过镜像管理驱动 <code>Graph driver</code> 将下载镜像以Graph的形式存储</li> <li>当需要为Docker创建网络环境时，通过网络驱动 <code>Network driver</code> 创建并配置Docker容器网络环境</li> <li>当需要限制Docker容器运行资源或执行用户指令等操作时，则通过 <code>Exec driver</code> 来完成</li> <li>Libcontainer是一项独立的容器管理包，Network driver以及Exec driver都是通过Libcontainer来实现具体容器进行的操作</li></ol> <img width="600px" src="/assets/img/17.901df447.png"> <br> <img width="600px" src="/assets/img/18.3aabb3be.png" style="margin-left:3px;"> <br> <h3 id="_2-4-安装步骤"><a href="#_2-4-安装步骤" class="header-anchor">#</a> 2.4 安装步骤</h3> <blockquote><p><strong>CentOS7安装Docker</strong></p></blockquote> <ol><li>确定系统是CentOS7以上版本</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 查看CentOS版本命令</span>
<span class="token function">cat</span> /etc/redhat-release
</code></pre></div><br> <ol start="2"><li>卸载旧版本</li></ol> <img src="/assets/img/19.37d0242d.png" style="zoom:50%;"> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 卸载旧版本docker命令</span>
$ <span class="token function">sudo</span> yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>
                  docker-client <span class="token punctuation">\</span>
                  docker-client-latest <span class="token punctuation">\</span>
                  docker-common <span class="token punctuation">\</span>
                  docker-latest <span class="token punctuation">\</span>
                  docker-latest-logrotate <span class="token punctuation">\</span>
                  docker-logrotate <span class="token punctuation">\</span>
                  docker-engine
</code></pre></div><br> <ol start="3"><li>yum安装gcc相关命令</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># yum安装gcc相关命令</span>
yum -y <span class="token function">install</span> gcc
yum -y <span class="token function">install</span> gcc-c++
</code></pre></div><br> <ol start="4"><li>安装需要的软件包</li></ol> <img src="/assets/img/20.47462de9.png" style="zoom:50%;"> <p>在新主机上首次安装Docker Engine之前，需要先设置Docker的yum源（软件仓库）。之后，您可以从软件仓库安装和更新Docker</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 安装yum-utils包（提供yum-config-manager命令），并设置docker的yum源</span>
yum <span class="token function">install</span> -y yum-utils

<span class="token comment"># 推荐使用阿里的 docker 镜像仓库，国外的镜像仓库是比较慢的</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

<span class="token comment"># 更新yum软件包索引</span>
yum makecache fast
</code></pre></div><br> <ol start="5"><li>安装DOCKER CE 引擎</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 命令</span>
yum -y <span class="token function">install</span> docker-ce docker-ce-cli containerd.io
</code></pre></div><br> <ol start="6"><li>启动docker</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 启动命令</span>
systemctl start <span class="token function">docker</span>
</code></pre></div><br> <ol start="7"><li>测试</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 测试</span>
<span class="token function">docker</span> version 
<span class="token function">docker</span> run hello-world
</code></pre></div><img src="/assets/img/22.79c8a528.png" style="zoom:50%;"> <br> <br> <ol start="8"><li>卸载</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 卸载命令</span>
systemctl stop <span class="token function">docker</span> 
yum remove docker-ce docker-ce-cli containerd.io
<span class="token function">rm</span> -rf /var/lib/docker
<span class="token function">rm</span> -rf /var/lib/containerd
</code></pre></div><h3 id="_2-5-阿里云镜像加速"><a href="#_2-5-阿里云镜像加速" class="header-anchor">#</a> 2.5 阿里云镜像加速</h3> <h4 id="_2-5-1-是什么"><a href="#_2-5-1-是什么" class="header-anchor">#</a> 2.5.1 是什么</h4> <ul><li>地址：https://promotion.aliyun.com/ntms/act/kubernetes.html</li> <li>注册一个属于自己的阿里云账户</li> <li>获得加速器地址连接：
<ol><li>登陆阿里云开发者平台</li> <li>点击控制台</li> <li>选择容器镜像服务</li> <li>获取加速器地址</li></ol></li> <li>粘贴脚本直接执行</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /etc/docker
<span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{ 
  &quot;registry-mirrors&quot;: [&quot;https://aa25jngu.mirror.aliyuncs.com&quot;]
} 
EOF</span> 
</code></pre></div><ul><li>重启服务器</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 重启服务器</span>
systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
</code></pre></div><h4 id="_2-5-2-helloworld"><a href="#_2-5-2-helloworld" class="header-anchor">#</a> 2.5.2 HelloWorld</h4> <p>启动Docker后台容器（测试运行 hello-world）</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 命令</span>
<span class="token function">docker</span> run hello-world
</code></pre></div><img src="/assets/img/24.f9095390.png" style="zoom:50%;"> <br> <h4 id="_2-5-3-底层原理"><a href="#_2-5-3-底层原理" class="header-anchor">#</a> 2.5.3 底层原理</h4> <p>为什么Docker会比VM虚拟机快：</p> <blockquote><p><strong>Docker有着比虚拟机更少的抽象层</strong></p> <ul><li>由于docker不需要Hypervisor(虚拟机)实现硬件资源虚拟化，运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。</li></ul> <br> <p><strong>Docker利用的是宿主机的内核，而不需要加载操作系统OS内核</strong></p> <ul><li>当新建一个容器时，docker不需要和虚拟机一样重新加载一个操作系统内核。进而避免引寻、加载操作系统内核返回等比较费时费资源的过程，当新建一个虚拟机时，虚拟机软件需要加载OS，返回新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统，则省略了返回过程，新建一个docker容器只需要几秒钟。</li></ul></blockquote> <img src="/assets/img/25.cb061719.png" style="zoom:60%;"> <br> <h2 id="_3-docker常用命令"><a href="#_3-docker常用命令" class="header-anchor">#</a> 3. Docker常用命令</h2> <h3 id="_3-1-启动帮助命令"><a href="#_3-1-启动帮助命令" class="header-anchor">#</a> 3.1 启动帮助命令</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 启动命令</span>
systemctl start <span class="token function">docker</span>
<span class="token comment"># 停止命令</span>
systemctl stop <span class="token function">docker</span>
<span class="token comment"># 重启命令</span>
systemctl restart <span class="token function">docker</span>
<span class="token comment"># 查看docker状态</span>
systemctl status <span class="token function">docker</span>
<span class="token comment"># 开机启动</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
<span class="token comment"># 查看 docker 概要信息</span>
<span class="token function">docker</span> info
<span class="token comment"># 查看docker 总体帮助文档</span>
<span class="token function">docker</span> --help
<span class="token comment"># 查看docker命令帮助文档：</span>
<span class="token function">docker</span> 具体命令 --help
</code></pre></div><h3 id="_3-2-镜像命令"><a href="#_3-2-镜像命令" class="header-anchor">#</a> 3.2 镜像命令</h3> <h4 id="_3-2-1-docker-image"><a href="#_3-2-1-docker-image" class="header-anchor">#</a> 3.2.1 docker image</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 列出本地主机上的镜像（或者 docker image ls）</span>
<span class="token function">docker</span> images 
</code></pre></div><img src="/assets/img/26.7523eccb.png" style="zoom:60%;"> <p>各个选项说明：</p> <ul><li>REPOSITORY：表示镜像的仓库源</li> <li>TAG：镜像的标签版本号</li> <li>IMAGE ID：镜像ID</li> <li>CREATED：镜像创建时间</li> <li>SIZE：镜像大小</li></ul> <p>同一仓库源可以有多个 TAG 版本，代表这个仓库源的不同版本，我们使用 REPOSITORY:TAG 来定义不同的镜像。</p> <p>如果你不指定一个镜像的版本标签，例如你只使用 ubuntu，docker 将默认使用 ubuntu:latest 镜像</p> <br> <p>OPTIONS 说明</p> <ul><li>-a :  列出本地所有的镜像（含历史映像层）</li> <li>-q：只显示镜像ID</li></ul> <h4 id="_3-2-2-docker-search"><a href="#_3-2-2-docker-search" class="header-anchor">#</a> 3.2.2 docker search</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 网站</span>
https://hub.docker.com
<span class="token comment"># 命令</span>
<span class="token function">docker</span> search <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> 镜像名字
<span class="token comment"># OPTIONS说明</span>
<span class="token comment"># --limit ：只列出N个镜像，默认25个</span>
<span class="token function">docker</span> search --limit <span class="token number">5</span> redis
</code></pre></div><p>案例</p> <img src="/assets/img/27.b5e45bee.png" style="zoom:60%;"> <h4 id="_3-2-3-docker-pull"><a href="#_3-2-3-docker-pull" class="header-anchor">#</a> 3.2.3 docker pull</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 下载镜像</span>
<span class="token function">docker</span> pull 镜像名字<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span>
 
<span class="token function">docker</span> pull  镜像名字
 
<span class="token comment"># 没有TAG就是最新版本 等价于</span>
<span class="token function">docker</span> pull 镜像名字:latest
<span class="token function">docker</span> pull ubuntu
</code></pre></div><img src="/assets/img/28.e0a75d9c.png" style="zoom:60%;"> <h4 id="_3-2-4-docker-system-df"><a href="#_3-2-4-docker-system-df" class="header-anchor">#</a> 3.2.4 docker system df</h4> <img src="/assets/img/29.f247e006.png" style="zoom:60%;"> <h4 id="_3-2-5-docker-rmi"><a href="#_3-2-5-docker-rmi" class="header-anchor">#</a> 3.2.5 docker rmi</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 删除单个</span>
<span class="token function">docker</span> rmi -f 镜像ID

<span class="token comment"># 删除多个</span>
<span class="token function">docker</span> rmi -f 镜像名1:TAG 镜像名2:TAG

<span class="token comment"># 删除全部</span>
<span class="token function">docker</span> rmi -f <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> images -qa<span class="token variable">)</span></span>
</code></pre></div><h4 id="_3-2-6-什么是虚悬镜像"><a href="#_3-2-6-什么是虚悬镜像" class="header-anchor">#</a> 3.2.6 什么是虚悬镜像</h4> <p>仓库名称，标签都是 <code>&lt;none&gt;</code> 的镜像，俗称虚悬镜像 dangling image</p> <p>长什么样子</p> <p>后续 Dockerfile 章节在介绍</p> <h3 id="_3-3-容器命令"><a href="#_3-3-容器命令" class="header-anchor">#</a> 3.3 容器命令</h3> <p>有镜像才能创建容器，这是根本前提（下载一个CentOS或者ubuntu镜像演示）</p> <p><strong>1. 说明</strong></p> <img src="/assets/img/30.b25b4554.png" style="zoom:60%;"> <br> <p><strong>2. docker pull centos</strong></p> <p><strong>3. docker pull ubuntu</strong></p> <p><strong>4. 本次演示用ubuntu演示</strong></p> <img src="/assets/img/31.a6476e8f.png" style="zoom:60%;"> <h4 id="_3-3-1-新建-启动容器"><a href="#_3-3-1-新建-启动容器" class="header-anchor">#</a> 3.3.1 新建+启动容器</h4> <p>新建+启动容器 命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> IMAGE COMMAND
</code></pre></div><p><strong>OPTIONS说明（常用）：有些是一个减号，有些是两个减号</strong></p> <ul><li><p>--name=&quot;容器新名字&quot;       为容器指定一个名称</p></li> <li><p>-d：后台运行容器并返回容器ID，也即启动守护式容器(后台运行)</p></li> <li><p>-i：以交互模式运行容器，通常与 -t 同时使用</p></li> <li><p>-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；也即 启动交互式容器(前台有伪终端，等待交互)</p></li> <li><p>-P:  随机 端口映射，大写P</p></li> <li><p>-p:  指定 端口映射，小写p</p></li></ul> <img src="/assets/img/32.4b50bb68.png" style="zoom:50%;"> <br> <p>启动交互式容器（前台命令行）</p> <img src="/assets/img/33.a65c3dff.png" style="zoom:60%;"> <br> <p>使用镜像 centos:latest 以交互模式启动一个容器，在容器内执行 /bin/bash 命令。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -it centos /bin/bash 
</code></pre></div><p>参数说明：</p> <ul><li>-i：交互式操作。</li> <li>-t：终端。</li> <li>centos：centos 镜像。</li> <li>/bin/bash：放在镜像名后的是命令，这里我们希望有个交互式 Shell，因此用的是 /bin/bash。 要退出终端，直接输入 exit</li></ul> <h4 id="_3-3-2-列出正在运行的容器"><a href="#_3-3-2-列出正在运行的容器" class="header-anchor">#</a> 3.3.2 列出正在运行的容器</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 列出当前所有正在运行的容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span>
<span class="token comment"># OPTIONS说明</span>
-a <span class="token builtin class-name">:</span> 列出当前所有 正在运行 的容器 + 历史上运行过 的 
-l :显示最近创建的容器。 
-n：显示最近n个创建的容器。 
-q :静默模式，只显示容器编号。 
</code></pre></div><h4 id="_3-3-3-退出容器"><a href="#_3-3-3-退出容器" class="header-anchor">#</a> 3.3.3 退出容器</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 两种退出方式</span>
<span class="token comment"># 1、run进去容器，exit退出，容器停止</span>
<span class="token builtin class-name">exit</span> 
<span class="token comment"># 2、run进去容器，ctrl+p+q退出，容器不停止</span>
ctrl+p+q
</code></pre></div><h4 id="_3-3-4-启动已停止运行的容器"><a href="#_3-3-4-启动已停止运行的容器" class="header-anchor">#</a> 3.3.4 启动已停止运行的容器</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 启动已停止运行的容器</span>
<span class="token function">docker</span> start 容器ID或者容器名
<span class="token comment"># 重启容器</span>
<span class="token function">docker</span> restart 容器ID或者容器名
<span class="token comment"># 停止容器</span>
<span class="token function">docker</span> stop 容器ID或者容器名
<span class="token comment"># 强制停止容器</span>
<span class="token function">docker</span> <span class="token function">kill</span> 容器ID或容器名
<span class="token comment"># 删除已停止的容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> 容器ID
<span class="token comment"># 一次性删除多个容器实例</span>
<span class="token function">docker</span> <span class="token function">rm</span> -rf <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> -a -q<span class="token variable">)</span></span>

<span class="token function">docker</span> <span class="token function">ps</span> -a -q <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">docker</span> <span class="token function">rm</span>
</code></pre></div><h4 id="_3-3-5-重要"><a href="#_3-3-5-重要" class="header-anchor">#</a> 3.3.5 重要</h4> <p><strong>启动守护式容器（后台服务器）</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#有镜像才能创建容器，这是根本前提（下载一个Redis6.0.8镜像演示）</span>
<span class="token comment">#在大部分的场景下，我们希望docker的服务是在后台运行的，我们可以通过 -d 指定容器的后台运行模式。</span>
<span class="token function">docker</span> run -d 容器名
<span class="token comment"># 使用镜像centos:latest以后台模式启动一个容器 </span>
<span class="token function">docker</span> run -d centos
</code></pre></div><p>问题：通过 <code>docker ps -a</code> 进行查看，会发现容器已经退出</p> <p>很重要的要说明的一点： Docker容器后台运行，就必须有一个前台进程。</p> <p>容器运行的命令如果不是那些 一直挂起的命令 （比如运行top，tail），就是会自动退出的。</p> <br> <p>这个是docker的机制问题，比如你的web容器，我们以nginx为例，正常情况下, 我们配置启动服务只需要启动响应的service即可。例如service nginx start。</p> <p>但是，这样做，nginx为后台进程模式运行，就导致docker前台没有运行的应用, 这样的容器后台启动后，会立即自杀因为他觉得他没事可做了。</p> <p>所以，最佳的解决方案是, 将你要运行的程序以前台进程的形式运行，常见就是命令行模式，表示我还有交互操作，别中断。</p> <br> <p><strong>redis前后台启动演示case</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 前台交互式启动</span>
<span class="token function">docker</span> run -it redis:6.0.8
<span class="token comment"># 后台交互式启动</span>
<span class="token function">docker</span> run -d redis:6.0.8
</code></pre></div><br> <p><strong>查看容器日志</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 查看容器内运行的进程</span>
<span class="token function">docker</span> <span class="token function">top</span> 容器ID
</code></pre></div><br> <p><strong>查看容器内部细节</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 查看容器内部细节</span>
<span class="token function">docker</span> inspect 容器ID
</code></pre></div><br> <p><strong>进入正在运行的容器并以命令行交互</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it 容器ID bashShell
</code></pre></div><img src="/assets/img/34.2fa0a9f9.png" style="zoom:60%;"> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> attach 容器ID
</code></pre></div><ol><li>attach 直接进入容器启动命令的终端，不会启动新的进程，用exit退出，会导致容器的停止。</li></ol> <img src="/assets/img/35.67a88dde.png" style="zoom:60%;"> <br> <ol start="2"><li>exec 是在容器中打开新的终端，并且可以启动新的进程，用exit退出，不会导致容器的停止。</li></ol> <img src="/assets/img/36.d0122cf7.png" style="zoom:60%;"> <br> <blockquote><p>推荐大家使用docker exec 命令，因为退出容器终端，不会导致容器的停止。</p></blockquote> <p>使用之前的redis容器实例进入试试</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it 容器ID /bin/bash

<span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it 容器ID redis-cli

<span class="token comment">#一般用-d后台启动的程序，在用exec进入对应容器实例</span>
</code></pre></div><br> <p><strong>从容器内拷贝文件到主机上</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token function">cp</span> 容器ID:容器内路径  目的主机路径
</code></pre></div><img src="/assets/img/37.567ff17a.png" style="zoom:60%;"> <br> <p><strong>导入和导出容器</strong></p> <ul><li><code>export</code> 导出容器的内容留作为一个tar归档文件 [对应import命令]</li> <li><code>import</code> 根据 tar 包中的内容创建一个新的文件系统并导入为镜像 [对应export]</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token builtin class-name">export</span> 容器ID  <span class="token operator">&gt;</span> 文件.tar 
</code></pre></div><img src="/assets/img/38.cc0dcf82.png" style="zoom:60%;"> <div class="language- extra-class"><pre class="language-text"><code>cat 文件名.tar  | docker  import  - 镜像用户/镜像名:镜像版本号
</code></pre></div><img src="/assets/img/39.3e18b424.png" style="zoom:60%;"> <h3 id="_3-4-小结"><a href="#_3-4-小结" class="header-anchor">#</a> 3.4 小结</h3> <img src="/assets/img/40.b1f1399e.png" style="zoom:50%;"> <br> <div class="language-shell extra-class"><pre class="language-shell"><code>attach    Attach to a running container                 <span class="token comment"># 当前 shell 下 attach 连接指定运行镜像 </span>
build     Build an image from a Dockerfile              <span class="token comment"># 通过 Dockerfile 定制镜像 </span>
commit    Create a new image from a container changes   <span class="token comment"># 提交当前容器为新的镜像 </span>
<span class="token function">cp</span>        Copy files/folders from the containers filesystem to the <span class="token function">host</span> path   <span class="token comment">#从容器中拷贝指定文件或者目录到宿主机中 </span>
create    Create a new container                        <span class="token comment"># 创建一个新的容器，同 run，但不启动容器 </span>
<span class="token function">diff</span>      Inspect changes on a container's filesystem   <span class="token comment"># 查看 docker 容器变化 </span>
events    Get real <span class="token function">time</span> events from the server          <span class="token comment"># 从 docker 服务获取容器实时事件 </span>
<span class="token builtin class-name">exec</span>      Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> an existing container        <span class="token comment"># 在已存在的容器上运行命令 </span>
<span class="token builtin class-name">export</span>    Stream the contents of a container as a <span class="token function">tar</span> archive   <span class="token comment"># 导出容器的内容流作为一个 tar 归档文件[对应 import ] </span>
<span class="token function">history</span>   Show the <span class="token function">history</span> of an image                  <span class="token comment"># 展示一个镜像形成历史 </span>
images    List images                                   <span class="token comment"># 列出系统当前镜像 </span>
<span class="token function">import</span>    Create a new filesystem image from the contents of a tarball <span class="token comment"># 从tar包中的内容创建一个新的文件系统映像[对应export] </span>
info      Display system-wide information               <span class="token comment"># 显示系统相关信息 </span>
inspect   Return low-level information on a container   <span class="token comment"># 查看容器详细信息 </span>
<span class="token function">kill</span>      Kill a running container                      <span class="token comment"># kill 指定 docker 容器 </span>
load      Load an image from a <span class="token function">tar</span> archive              <span class="token comment"># 从一个 tar 包中加载一个镜像[对应 save] </span>
login     Register or Login to the <span class="token function">docker</span> registry server    <span class="token comment"># 注册或者登陆一个 docker 源服务器 </span>
<span class="token builtin class-name">logout</span>    Log out from a Docker registry server          <span class="token comment"># 从当前 Docker registry 退出 </span>
logs      Fetch the logs of a container                 <span class="token comment"># 输出当前容器日志信息 </span>
port      Lookup the public-facing port <span class="token function">which</span> is NAT-ed to PRIVATE_PORT    <span class="token comment"># 查看映射端口对应的容器内部源端口 </span>
pause     Pause all processes within a container        <span class="token comment"># 暂停容器 </span>
<span class="token function">ps</span>        List containers                               <span class="token comment"># 列出容器列表 </span>
pull      Pull an image or a repository from the <span class="token function">docker</span> registry server   <span class="token comment"># 从docker镜像源服务器拉取指定镜像或者库镜像 </span>
push      Push an image or a repository to the <span class="token function">docker</span> registry server    <span class="token comment"># 推送指定镜像或者库镜像至docker源服务器 </span>
restart   Restart a running container                   <span class="token comment"># 重启运行的容器 </span>
<span class="token function">rm</span>        Remove one or <span class="token function">more</span> containers                 <span class="token comment"># 移除一个或者多个容器 </span>
rmi       Remove one or <span class="token function">more</span> images       <span class="token comment"># 移除一个或多个镜像[无容器使用该镜像才可删除，否则需删除相关容器才可继续或 -f 强制删除] </span>
run       Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a new container              <span class="token comment"># 创建一个新的容器并运行一个命令 </span>
save      Save an image to a <span class="token function">tar</span> archive                <span class="token comment"># 保存一个镜像为一个 tar 包[对应 load] </span>
search    Search <span class="token keyword">for</span> an image on the Docker Hub         <span class="token comment"># 在 docker hub 中搜索镜像 </span>
start     Start a stopped containers                    <span class="token comment"># 启动容器 </span>
stop      Stop a running containers                     <span class="token comment"># 停止容器 </span>
tag       Tag an image into a repository                <span class="token comment"># 给源中镜像打标签 </span>
<span class="token function">top</span>       Lookup the running processes of a container   <span class="token comment"># 查看容器中运行的进程信息 </span>
unpause   Unpause a paused container                    <span class="token comment"># 取消暂停容器 </span>
version   Show the <span class="token function">docker</span> version information           <span class="token comment"># 查看 docker 版本号 </span>
<span class="token function">wait</span>      Block <span class="token keyword">until</span> a container stops, <span class="token keyword">then</span> print its <span class="token builtin class-name">exit</span> code   <span class="token comment"># 截取容器停止时的退出状态值</span>
</code></pre></div><h2 id="_4-docker镜像"><a href="#_4-docker镜像" class="header-anchor">#</a> 4. Docker镜像</h2> <h3 id="_4-1-简介"><a href="#_4-1-简介" class="header-anchor">#</a> 4.1 简介</h3> <p><strong>镜像</strong></p> <ul><li>是一种轻量级、可执行的独立软件包，它包含运行某个软件所需的所有内容，我们把应用程序和配置依赖打包好形成一个可交付的运行环境（包括代码、运行时需要的库、环境变量和配置文件等)，这个打包好的运行环境就是image镜像文件。</li> <li>只有通过这个镜像文件才能生成Docker容器实例(类似Java中new出来一个对象)。</li></ul> <br> <p><strong>分层镜像</strong></p> <ul><li>以我们的pull为例，在下载的过程中我们可以看到docker的镜像好像是在一层一层的在下载 。</li></ul> <br> <p><strong>UnionFS（联合文件系统）</strong></p> <ul><li>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加， 同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基础。 镜像可以通过分层来进行继承 ，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</li> <li>特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</li></ul> <br> <br> <br> <p><strong>镜像加载原理</strong></p> <p>Docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统叫做UnionFS。</p> <p>bootfs(boot file system)主要包含bootloader和kernel，bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统， 在Docker镜像的最底层是引导文件系统bootfs。 这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</p> <p>rootfs (root file system) ，在bootfs之上 。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p> <img src="/assets/img/41.fd635ffe.png" style="zoom:50%;"> <br> <br> <p>平时我们安装进虚拟机的CentOS都是好几个G，为什么docker这里才200M？</p> <img src="/assets/img/42.eef76c75.png" style="zoom:50%;"> <ul><li>对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令、工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供 rootfs 就行了。由此可见对于不同的linux发行版，bootfs基本是一致的，rootfs会有差别，因此不同的发行版可以公用bootfs。</li></ul> <br> <br> <p>为什么Docker镜像要采用这种分层结构呢？</p> <ul><li>镜像分层最大的一个好处就是共享资源，方便复制迁移，就是为了复用。 比如说有多个镜像都从相同的 base 镜像构建而来，那么 Docker Host 只需在磁盘上保存一份 base 镜像； 同时内存中也只需加载一份 base 镜像，就可以为所有容器服务了。而且镜像的每一层都可以被共享。</li></ul> <h3 id="_4-2-重点理解"><a href="#_4-2-重点理解" class="header-anchor">#</a> 4.2 重点理解</h3> <p>Docker镜像层都是只读的，容器层是可写的，当容器启动时，一个新的可写层被加载到镜像的顶部。这一层通常被称作“容器层“，“容器层“之下的都叫“镜像层”。</p> <p>所有对容器的改动 - 无论添加、删除、还是修改文件都只会发生在容器层中。只有容器层是可写的，容器层下面的所有镜像层都是只读的。</p> <img src="/assets/img/43.9c70eaa6.png" style="zoom:50%;"> <h3 id="_4-3-commit操作"><a href="#_4-3-commit操作" class="header-anchor">#</a> 4.3 commit操作</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> commit 提交容器副本使之成为一个新的镜像

<span class="token function">docker</span> commit -m<span class="token operator">=</span><span class="token string">&quot;提交的描述信息&quot;</span> -a<span class="token operator">=</span><span class="token string">&quot;作者&quot;</span> 容器ID  要创建的目标镜像名:<span class="token punctuation">[</span>标签名<span class="token punctuation">]</span>
</code></pre></div><p>【案例演示】ubuntu安装vim</p> <ol><li>从Hub上下ubuntu镜像到本地并成功运行</li> <li>原始默认Ubuntu镜像是不带着vim命令的</li> <li>外网连通情况下，安装vim</li></ol> <p>docker容器内执行上述两条命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 先更新我们的包管理工具</span>
<span class="token function">apt-get</span> update
<span class="token comment"># 然后安装我们需要的vim</span>
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">vim</span>
</code></pre></div><img src="/assets/img/44.aab0378d.png" style="zoom:40%;"> <br> <ol start="4"><li>安装完成后，commit我们自己的新镜像</li></ol> <img src="/assets/img/45.04c2103f.png" style="zoom:40%;"> <ol start="5"><li>启动我们的新镜像并和原来的对比</li></ol> <img src="/assets/img/46.1e99f705.png" style="zoom:40%;"> <p>官网是默认下载的Ubuntu没有vim命令</p> <p>我们自己commit构建的镜像，新增加了vim功能，可以成功使用。</p> <h3 id="_4-4-总结"><a href="#_4-4-总结" class="header-anchor">#</a> 4.4 总结</h3> <p>Docker中的镜像分层， 支持通过扩展现有镜像，创建新的镜像 。类似Java继承于一个Base基础类，自己再按需扩展。
新镜像是从 base 镜像一层一层叠加生成的。每安装一个软件，就在现有镜像的基础上增加一层。</p> <img src="/assets/img/47.d994d2dc.png" style="zoom:60%;"> <br> <br> <h2 id="_5-镜像发布到阿里云"><a href="#_5-镜像发布到阿里云" class="header-anchor">#</a> 5. 镜像发布到阿里云</h2> <h3 id="_5-1-镜像发布到阿里云流程"><a href="#_5-1-镜像发布到阿里云流程" class="header-anchor">#</a> 5.1 镜像发布到阿里云流程</h3> <img src="/assets/img/48.bde34583.png" style="zoom:70%;"> <h3 id="_5-2-镜像生成的方法"><a href="#_5-2-镜像生成的方法" class="header-anchor">#</a> 5.2 镜像生成的方法</h3> <p>基于当前容器创建一个新的镜像</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> commit <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> 容器ID <span class="token punctuation">[</span>REPOSOTORY<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><p>OPTIONS说明：</p> <ul><li>-a：提交的镜像作者</li> <li>-m：提交时的说明文字</li></ul> <img src="/assets/img/49.fc74cd8c.png" style="zoom:70%;"> <br> <br> <p><strong>阿里云开发者平台</strong></p> <p>地址：https://promotion.aliyun.com/ntms/act/kubernetes.html</p> <p>将镜像推送到阿里云registry ，管理界面脚本</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> login --username<span class="token operator">=</span>zzyybuy registry.cn-hangzhou.aliyuncs.com 

<span class="token function">docker</span> tag cea1bb40441c registry.cn-hangzhou.aliyuncs.com/atguiguwh/myubuntu:1.1 

<span class="token function">docker</span> push registry.cn-hangzhou.aliyuncs.com/atguiguwh/myubuntu:1.1

<span class="token comment"># 上面命令是作者自己本地的，你自己酌情处理，不要粘贴我的</span>
</code></pre></div><img src="/assets/img/53.e7f13a6e.png" style="zoom:70%;"> <br> <br> <h2 id="_6-阿里云镜像下载到本地"><a href="#_6-阿里云镜像下载到本地" class="header-anchor">#</a> 6. 阿里云镜像下载到本地</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> pull registry.cn-hangzhou.aliyuncs.com/atguiguwh/myubuntu:1.1
</code></pre></div><img src="/assets/img/54.36c6d873.png" style="zoom:70%;"> <br> <br> <h2 id="_7-本地镜像发布到私有库"><a href="#_7-本地镜像发布到私有库" class="header-anchor">#</a> 7. 本地镜像发布到私有库</h2> <ol><li>下载镜像 Docker Registry</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> pull registry  
</code></pre></div><img src="/assets/img/55.45c60ea7.png" style="zoom:50%;"> <br> <br> <ol start="2"><li>运行私有库Registry，相当于本地有个私有库Docker hub</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -d -p <span class="token number">5000</span>:5000 -v /zzyyuse/myregistry/:/tmp/registry --privileged<span class="token operator">=</span>true registry
</code></pre></div><p>默认情况，仓库被创建在容器的 /var/lib/registry 目录下，建议自行用容器卷映射，方便于宿主机联调</p> <img src="/assets/img/56.2cbd81d3.png" style="zoom:50%;"> <br> <br> <ol start="3"><li>创建一个新镜像，ubuntu安装ifconfig命令</li></ol> <p>从Hub上下载ubuntu镜像到本地并成功运行（原始Ubuntu镜像是不带着ifconfig命令的）</p> <img src="/assets/img/57.e03d1497.png" style="zoom:40%;"> <p>外网连通情况下，安装ifconfig命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#docker容器内 执行上述两条命令</span>
<span class="token function">apt-get</span> update 
<span class="token function">apt-get</span> <span class="token function">install</span> net-tools 
</code></pre></div><img src="/assets/img/58.1ed5c15e.png" style="zoom:40%;"> <br> <img src="/assets/img/59.f1f4c6bc.png" style="zoom:40%;"> <p>安装完成后，commit我们自己的新镜像</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot;  容器ID  要创建的目标镜像名:[标签名] </span>
<span class="token function">docker</span> commit -m<span class="token operator">=</span><span class="token string">&quot;ifconfig cmd add&quot;</span> -a<span class="token operator">=</span><span class="token string">&quot;zzyy&quot;</span> a69d7c825c4f  zzyyubuntu:1.2 
</code></pre></div><img src="/assets/img/60.25697049.png" style="zoom:40%;"> <p>启动我们的新镜像并和原来的对比</p> <ul><li>官网是默认下载的Ubuntu没有ifconfig命令</li> <li>我们自己commit构建的新镜像，新增加了ifconfig功能，可以成功使用</li></ul> <img src="/assets/img/61.9bc8dd56.png" style="zoom:40%;"> <br> <br> <ol start="4"><li>curl验证私服库上有什么镜像</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">curl</span> -XGET http://192.168.111.162:5000/v2/_catalog 
</code></pre></div><p>可以看到，目前私服库没有任何镜像上传过</p> <img src="/assets/img/62.a20be952.png" style="zoom:40%;"> <br> <br> <ol start="5"><li>将新镜像 zzyyubuntu:1.2 修改符合私服规范的Tag</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#按照公式： docker   tag   镜像:Tag   Host:Port/Repository:Tag </span>
<span class="token comment">#自己host主机IP地址，填写你们自己的</span>
<span class="token comment">#使用命令 docker tag 将zzyyubuntu:1.2 这个镜像修改为192.168.111.162:5000/zzyyubuntu:1.2 </span>
<span class="token function">docker</span> tag  zzyyubuntu:1.2  <span class="token number">192.168</span>.111.162:5000/zzyyubuntu:1.2 
</code></pre></div><img src="/assets/img/63.78ed3f21.png" style="zoom:40%;"> <br> <br> <ol start="6"><li>修改配置文件使之支持http</li></ol> <img src="/assets/img/64.916772db.png" style="zoom:40%;"> <blockquote><p>registry-mirrors 配置的是国内阿里提供的镜像加速地址，不用加速的话访问官网的会很慢。</p> <p>2个配置中间有个逗号 ','别漏了，这个配置是json格式的。</p></blockquote> <p>vim命令新增如下红色内容：vim /etc/docker/daemon.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://aa25jngu.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> 
  <span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;192.168.111.162:5000&quot;</span><span class="token punctuation">]</span> 
<span class="token punctuation">}</span> 
</code></pre></div><p>docker默认不允许http方式推送镜像，通过配置选项来取消这个限制</p> <p>修改完后如果不生效，建议重启docker</p> <br> <br> <ol start="7"><li>push推送到私服库</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> push <span class="token number">192.168</span>.111.162:5000/zzyyubuntu:1.2 
</code></pre></div><img src="/assets/img/65.5704d3ef.png" style="zoom:40%;"> <br> <br> <ol start="8"><li>curl验证私服库上有什么镜像</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">curl</span> -XGET http://192.168.111.162:5000/v2/_catalog 
</code></pre></div><img src="/assets/img/66.cfc66d59.png" style="zoom:40%;"> <br> <br> <ol start="9"><li>pull到本地并运行</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> pull <span class="token number">192.168</span>.111.162:5000/zzyyubuntu:1.2
</code></pre></div><img src="/assets/img/67.298ef8c4.png" style="zoom:40%;"> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -it 镜像ID /bin/bash 
</code></pre></div><img src="/assets/img/68.febb04ad.png" style="zoom:40%;"> <br> <br> <h2 id="_8-数据卷"><a href="#_8-数据卷" class="header-anchor">#</a> 8. 数据卷</h2> <h3 id="_8-1-坑-容器卷记得加入"><a href="#_8-1-坑-容器卷记得加入" class="header-anchor">#</a> 8.1 坑：容器卷记得加入</h3> <p><code>--privileged=true</code></p> <p>Docker挂载主机目录访问，如果出现 cannot open directory .: Permission denied</p> <p>解决办法：在挂载目录后多加一个--privileged=true参数即可</p> <br> <p>如果是CentOS7安全模块会比之前系统版本加强，不安全的会先禁止，所以目录挂载的情况被默认为不安全的行为</p> <p>在SELinux里面挂载目录被禁止，如果要开启，我们一般使用--privileged=true命令，扩大容器的权限解决挂载目录没有权限的问题，也即使用该参数，container内的root拥有真正的root权限，否则，container内的root只是外部的一个普通用户权限。</p> <h3 id="_8-2-参数v"><a href="#_8-2-参数v" class="header-anchor">#</a> 8.2 参数V</h3> <p>还记得蓝色框框中的内容吗？</p> <img src="/assets/img/69.2b39d219.png" style="zoom:40%;"> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 有点类似我们Redis里面的rdb和aof文件</span>
<span class="token comment"># 将docker容器内的数据保存进宿主机的磁盘中</span>
<span class="token comment"># 运行一个带有容器卷存储功能的容器实例</span>
<span class="token function">docker</span> run -it --privileged<span class="token operator">=</span>true -v /宿主机绝对路径目录:/容器内目录      镜像名
</code></pre></div><p>特点：</p> <ul><li>数据卷可在容器之间共享或重用数据</li> <li>卷中的更改可以直接实时生效，爽</li> <li>数据卷中的更改不会包含在镜像的更新中</li> <li>数据卷的生命周期一直持续到没有容器使用它为止</li></ul> <h3 id="_8-3-案例"><a href="#_8-3-案例" class="header-anchor">#</a> 8.3 案例</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 公式：docker run -it -v /宿主机目录:/容器内目录</span>
<span class="token function">docker</span> run -it --name myu3 --privileged<span class="token operator">=</span>true -v /tmp/myHostData:/tmp/myDockerData ubuntu /bin/bash
</code></pre></div><img src="/assets/img/70.024f151c.png" style="zoom:40%;"> <br> <br> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#查看数据卷是否挂成功</span>
<span class="token function">docker</span> inspect 容器ID
</code></pre></div><img src="/assets/img/71.b216d1e3.png" style="zoom:60%;"> <br> <br> <p>容器和宿主机之间数据共享</p> <ul><li>docker修改，主机同步获得</li> <li>主机修改，docker同步获得</li></ul> <br> <br> <h4 id="_8-3-1-读写规则映射添加说明"><a href="#_8-3-1-读写规则映射添加说明" class="header-anchor">#</a> 8.3.1 读写规则映射添加说明</h4> <ol><li>读写(默认)</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -it --privileged<span class="token operator">=</span>true -v /宿主机绝对路径目录:/容器内目录:rw  镜像名
<span class="token comment">#默认同上案例，默认就是rw</span>
</code></pre></div><img src="/assets/img/73.80b209b0.png" style="zoom:40%;"> <ol start="2"><li>只读</li></ol> <p>容器实例内部被限制，只能读取不能写</p> <img src="/assets/img/74.e1cfb46b.png" style="zoom:40%;"> <div class="language-shell extra-class"><pre class="language-shell"><code> <span class="token function">docker</span> run -it --privileged<span class="token operator">=</span>true -v /宿主机绝对路径目录:/容器内目录:ro      镜像名
</code></pre></div><br> <br> <h4 id="_8-3-2-卷的集成和共享"><a href="#_8-3-2-卷的集成和共享" class="header-anchor">#</a> 8.3.2 卷的集成和共享</h4> <p>容器1完成和宿主机的映射</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -it --privileged<span class="token operator">=</span>true -v /mydocker/u:/tmp --name u1 ubuntu
</code></pre></div><img src="/assets/img/75.ad440519.png" style="zoom:40%;"> <br> <p>容器2集成容器1的卷规则</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run -it --privileged<span class="token operator">=</span>true --volumes-from 父类 --name u2 ubuntu
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/devops/docker/advanced.html">
        高级部分
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0bfcc16d.js" defer></script><script src="/assets/js/5.5b20aa35.js" defer></script><script src="/assets/js/4.589a219c.js" defer></script>
  </body>
</html>
